<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <title>Ефемериди</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      padding: 30px;
      background: #fff;
      color: #2c3e50;
    }
    .header {
      display: flex;
      align-items: center;
      border-bottom: 2px solid #ddd;
      padding-bottom: 20px;
      margin-bottom: 30px;
    }
    .header img {
      height: 70px;
      margin-right: 20px;
    }
    .header-text h1 {
      font-size: 20px;
      margin: 0 0 6px;
      font-weight: 600;
    }
    .header-text p {
      margin: 0;
      font-size: 14px;
      color: #555;
    }
    h2 {
      font-size: 22px;
      margin: 0 0 25px;
    }
    h3 {
      margin: 30px 0 10px;
      font-size: 18px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    th, td {
      padding: 10px;
      text-align: center;
      border: 1px solid #ddd;
    }
    th {
      background: #34495E;
      color: #ECF0F1;
      font-weight: 600;
    }
    tr:nth-child(even) {
      background: #F7F9FA;
    }
    .footer {
      margin-top: 50px;
      font-size: 12px;
      text-align: center;
      color: #888;
    }
  </style>
</head>
<body>

  <div class="header">
    <img src="https://i.postimg.cc/DZh0SV41/image.png" alt="Логотип">
    <div class="header-text">
      <h1>Міжнародний інститут прикладної астрології, парапсихології та досліджень аномальних явищ Е-ТЕРРА</h1>
      <p><a href="https://e-terra.com.ua" target="_blank">https://e-terra.com.ua</a></p>
    </div>
  </div>

  <h2 id="report-title">Ефемериди</h2>
  <div id="ephemerides-content">Завантаження…</div>

  <div class="footer">
    Звіт згенеровано автоматично. Дані: NASA JPL / Ephemerides API.<br>
    Інститут Е-ТЕРРА, © 2025
  </div>

  <script>
    <script>
(async () => {
  const params = new URLSearchParams(window.location.search);
  const city  = params.get("city")  || "";
  const start = params.get("start") || "";
  const end   = params.get("end")   || "";
  const time  = params.get("time")  || "";

  // 1) Мапа англ→укр назв планет
  const PLANET_NAMES = {
    Sun:      'Сонце',
    Moon:     'Місяць',
    Mercury:  'Меркурій',
    Venus:    'Венера',
    Mars:     'Марс',
    Jupiter:  'Юпітер',
    Saturn:   'Сатурн',
    Uranus:   'Уран',
    Neptune:  'Нептун',
    Pluto:    'Плутон',
    // Якщо в positions є інші ключі – додай сюди
  };

  // 2) Мапа англ→укр назв аспектів
  const ASPECT_NAMES = {
    conjunction: 'з’єднання',
    opposition:  'опозиція',
    trine:       'трин',
    square:      'квадратура',
    sextile:     'секстиль',
    // Додай інші, якщо потрібно
  };

  // ... (твоїй код до виклику fetch геокоду)
  // Після отримання data:
  const SIGNS = ['Овен','Телець','Близнюки','Рак','Лев','Діва','Терези','Скорпіон','Стрілець','Козоріг','Водолій','Риби'];
  const content = document.getElementById("ephemerides-content");
  content.innerHTML = "";

  // Припустимо, ти вже дістяв lat, lon, dStart, dEnd
  for (let d = new Date(start); d <= new Date(end); d.setDate(d.getDate()+1)) {
    const ds = d.toISOString().split('T')[0];
    // ... твій код конвертації часу і запиту API ...
    const data = await fetch(apiUrl).then(r=>r.json());

    // Сиферичний час, ASC/MC — без змін
    let html = `<h3>${ds}</h3>`;
    // ...

    // 3) Таблиця позицій планет з українськими іменами:
    html += `<table><thead><tr><th>Планета</th><th>Довгота,°</th><th>Знак</th></tr></thead><tbody>`;
    for (let [pl, lonVal] of Object.entries(data.positions)) {
      const nameUa = PLANET_NAMES[pl] || pl;
      const idx = Math.floor((lonVal % 360) / 30);
      const deg = (lonVal % 30).toFixed(2);
      html += `<tr>
        <td>${nameUa}</td>
        <td>${lonVal.toFixed(2)}</td>
        <td>${SIGNS[idx]} ${deg}°</td>
      </tr>`;
    }
    html += `</tbody></table>`;

    // 4) Таблиця аспектів з українськими назвами:
    html += `<table><thead><tr><th>Аспект</th><th>Між</th><th>Кут,°</th></tr></thead><tbody>`;
    for (let a of data.aspects) {
      const aspectUa = ASPECT_NAMES[a.aspect] || a.aspect;
      // Перекладаємо обидві планети в аспекті
      const betweenUa = a.between
        .map(pl => PLANET_NAMES[pl] || pl)
        .join(' – ');
      html += `<tr>
        <td>${aspectUa}</td>
        <td>${betweenUa}</td>
        <td>${a.angle.toFixed(2)}</td>
      </tr>`;
    }
    html += `</tbody></table>`;

    content.innerHTML += html;
  }
})();
</script>


</body>
</html>
